---
sidebar_position: 1
title: 协调器
---

# 协调器 (Coordinator)

Coordinator 是 Memfit AI 的核心枢纽，充当系统总线和生命周期管理器。

## 核心职责

### 会话上下文管理

Coordinator 管理会话的所有方面：
- 维护对话历史
- 跟踪任务状态和进度
- 管理用户偏好和设置
- 协调各组件之间的通信

### 配置加载

Coordinator 处理系统配置：
- 加载工具配置
- 初始化 Forge 模块
- 设置记忆和 RAG 系统
- 配置可靠性机制

### 用户意图桥梁

作为用户意图与系统执行之间的桥梁：
- 解释用户请求
- 路由到适当的执行模式
- 管理人机协作交互
- 处理中断和取消

## 任务状态机

Coordinator 维护全局任务状态机：

```
┌─────────┐     ┌──────────┐     ┌───────────┐
│  待处理  │ ──→ │   规划中  │ ──→ │   审查中   │
└─────────┘     └──────────┘     └─────┬─────┘
                                       ↓
┌──────────┐     ┌───────────┐     ┌───────────┐
│  已完成   │ ←── │   执行中   │ ←── │   已批准   │
└──────────┘     └───────────┘     └───────────┘
```

### 状态说明

| 状态 | 描述 |
|------|------|
| 待处理 | 任务已接收，等待处理 |
| 规划中 | Plan 引擎正在生成任务树 |
| 审查中 | 人工审查阶段 |
| 已批准 | 计划已批准，准备执行 |
| 执行中 | ReAct loops 正在运行 |
| 已完成 | 所有子任务完成 |

## 子任务监控

Coordinator 监控所有子任务执行：
- 跟踪各子任务进度
- 检测失败并触发恢复
- 管理资源分配
- 向用户界面报告状态

## 交互模式

### Plan-Execute 模式

1. 接收复杂用户意图
2. 初始化 Plan 引擎
3. 生成任务树
4. 呈现供用户审查
5. 批准后分发到 ReAct loops
6. 监控执行
7. 报告结果

### 即时执行模式

1. 接收原子化指令
2. 直接分发到 ReAct loop
3. 监控执行
4. 立即返回结果

## 集成点

Coordinator 与所有主要组件集成：
- **Plan 引擎** - 任务分解
- **ReAct Loops** - 任务执行
- **Memory Triage** - 上下文增强
- **RAG System** - 知识检索
- **Tools & Forges** - 能力访问

